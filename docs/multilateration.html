<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Multilateration | ‘celltracktech’ Data Analysis package</title>
  <meta name="description" content="This is a manual for the R package ‘celltracktech’" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Multilateration | ‘celltracktech’ Data Analysis package" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a manual for the R package ‘celltracktech’" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Multilateration | ‘celltracktech’ Data Analysis package" />
  
  <meta name="twitter:description" content="This is a manual for the R package ‘celltracktech’" />
  

<meta name="author" content="Jessica Gorzo" />


<meta name="date" content="2025-05-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="CTT-FB-logo-STACKED.jpg" type="image/x-icon" />
<link rel="prev" href="grid-search-analysis.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CTT Data Tools</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> AOS2024 - ‘celltracktech’ Workshop</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#additional-libraries-needed-linux-users"><i class="fa fa-check"></i><b>1.1</b> Additional Libraries Needed (Linux users)</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#install-postgresql-libraries"><i class="fa fa-check"></i><b>1.1.1</b> Install PostgreSQL libraries</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#installing-r-spatial-on-ubuntu"><i class="fa fa-check"></i><b>1.1.2</b> Installing R Spatial on Ubuntu</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="project-setup.html"><a href="project-setup.html"><i class="fa fa-check"></i><b>2</b> Project Setup</a>
<ul>
<li class="chapter" data-level="2.1" data-path="project-setup.html"><a href="project-setup.html#create-an-r-studio-project"><i class="fa fa-check"></i><b>2.1</b> Create an R Studio Project</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="project-setup.html"><a href="project-setup.html#git"><i class="fa fa-check"></i><b>2.1.1</b> Git</a></li>
<li class="chapter" data-level="2.1.2" data-path="project-setup.html"><a href="project-setup.html#renv"><i class="fa fa-check"></i><b>2.1.2</b> <code>renv</code></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="project-setup.html"><a href="project-setup.html#request-an-api-token"><i class="fa fa-check"></i><b>2.2</b> Request an API token</a></li>
<li class="chapter" data-level="2.3" data-path="project-setup.html"><a href="project-setup.html#create-a-.env-file"><i class="fa fa-check"></i><b>2.3</b> Create a ‘.env’ file</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="project-setup.html"><a href="project-setup.html#load-the-api-key-into-your-rstudio-environment"><i class="fa fa-check"></i><b>2.3.1</b> Load the API key into your RStudio environment</a></li>
<li class="chapter" data-level="2.3.2" data-path="project-setup.html"><a href="project-setup.html#add-.env-file-to-.gitignore"><i class="fa fa-check"></i><b>2.3.2</b> Add .env file to .gitignore</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="project-setup.html"><a href="project-setup.html#organize-your-project-directory"><i class="fa fa-check"></i><b>2.4</b> Organize your Project Directory</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="download-data.html"><a href="download-data.html"><i class="fa fa-check"></i><b>3</b> Download Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="download-data.html"><a href="download-data.html#create-a-duckdb-database"><i class="fa fa-check"></i><b>3.1</b> Create a DuckDB database</a></li>
<li class="chapter" data-level="3.2" data-path="download-data.html"><a href="download-data.html#download-data-from-the-ctt-api"><i class="fa fa-check"></i><b>3.2</b> Download data from the CTT API</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="download-data.html"><a href="download-data.html#create-database-from-files-on-your-computer"><i class="fa fa-check"></i><b>3.2.1</b> Create Database from Files on your Computer</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="download-data.html"><a href="download-data.html#updating-the-database"><i class="fa fa-check"></i><b>3.3</b> Updating the database</a></li>
<li class="chapter" data-level="3.4" data-path="download-data.html"><a href="download-data.html#disconnecting-from-the-database"><i class="fa fa-check"></i><b>3.4</b> Disconnecting from the database</a></li>
<li class="chapter" data-level="3.5" data-path="download-data.html"><a href="download-data.html#uploading-node-data-from-the-sd-card"><i class="fa fa-check"></i><b>3.5</b> Uploading Node Data from the SD Card</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="download-data.html"><a href="download-data.html#create-nodes-directory"><i class="fa fa-check"></i><b>3.5.1</b> Create Nodes directory</a></li>
<li class="chapter" data-level="3.5.2" data-path="download-data.html"><a href="download-data.html#create-individual-directories-for-each-node"><i class="fa fa-check"></i><b>3.5.2</b> Create individual directories for each Node</a></li>
<li class="chapter" data-level="3.5.3" data-path="download-data.html"><a href="download-data.html#upload-node-data-to-your-duckdb-database"><i class="fa fa-check"></i><b>3.5.3</b> Upload Node data to your DuckDB database</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="download-data.html"><a href="download-data.html#create-postgres-database"><i class="fa fa-check"></i><b>3.6</b> Create Postgres Database</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="obtaining-data-from-database.html"><a href="obtaining-data-from-database.html"><i class="fa fa-check"></i><b>4</b> Obtaining Data from Database</a>
<ul>
<li class="chapter" data-level="4.1" data-path="obtaining-data-from-database.html"><a href="obtaining-data-from-database.html#duckplyr"><i class="fa fa-check"></i><b>4.1</b> Duckplyr</a></li>
<li class="chapter" data-level="4.2" data-path="obtaining-data-from-database.html"><a href="obtaining-data-from-database.html#sql-queries"><i class="fa fa-check"></i><b>4.2</b> SQL Queries</a></li>
<li class="chapter" data-level="4.3" data-path="obtaining-data-from-database.html"><a href="obtaining-data-from-database.html#list-tables"><i class="fa fa-check"></i><b>4.3</b> List Tables</a></li>
<li class="chapter" data-level="4.4" data-path="obtaining-data-from-database.html"><a href="obtaining-data-from-database.html#find-unique-tags-in-raw-table"><i class="fa fa-check"></i><b>4.4</b> Find unique tags in <code>raw</code> table</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="node-check.html"><a href="node-check.html"><i class="fa fa-check"></i><b>5</b> Node Check</a>
<ul>
<li class="chapter" data-level="5.1" data-path="node-check.html"><a href="node-check.html#node-health"><i class="fa fa-check"></i><b>5.1</b> Node Health</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="node-check.html"><a href="node-check.html#node-health---check-health-records"><i class="fa fa-check"></i><b>5.1.1</b> Node Health - Check Health Records</a></li>
<li class="chapter" data-level="5.1.2" data-path="node-check.html"><a href="node-check.html#battery-and-solar-levels"><i class="fa fa-check"></i><b>5.1.2</b> Battery and Solar Levels</a></li>
<li class="chapter" data-level="5.1.3" data-path="node-check.html"><a href="node-check.html#check-gps"><i class="fa fa-check"></i><b>5.1.3</b> Check GPS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="node-calibration.html"><a href="node-calibration.html"><i class="fa fa-check"></i><b>6</b> Node Calibration</a>
<ul>
<li class="chapter" data-level="6.1" data-path="node-calibration.html"><a href="node-calibration.html#load-sidekick-data-file"><i class="fa fa-check"></i><b>6.1</b> Load sidekick data file</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="node-calibration.html"><a href="node-calibration.html#if-you-do-not-have-a-sidekick-data-file"><i class="fa fa-check"></i><b>6.1.1</b> IF YOU DO NOT HAVE A SIDEKICK DATA FILE:</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="node-calibration.html"><a href="node-calibration.html#setup"><i class="fa fa-check"></i><b>6.2</b> Setup</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="node-calibration.html"><a href="node-calibration.html#load-environmental-variables-into-rstudio"><i class="fa fa-check"></i><b>6.2.1</b> Load environmental variables into RStudio</a></li>
<li class="chapter" data-level="6.2.2" data-path="node-calibration.html"><a href="node-calibration.html#load-settings"><i class="fa fa-check"></i><b>6.2.2</b> Load settings</a></li>
<li class="chapter" data-level="6.2.3" data-path="node-calibration.html"><a href="node-calibration.html#load-node-health-data-from-files"><i class="fa fa-check"></i><b>6.2.3</b> Load Node Health Data from Files</a></li>
<li class="chapter" data-level="6.2.4" data-path="node-calibration.html"><a href="node-calibration.html#get-node-locations"><i class="fa fa-check"></i><b>6.2.4</b> Get Node Locations</a></li>
<li class="chapter" data-level="6.2.5" data-path="node-calibration.html"><a href="node-calibration.html#load-station-detection-from-files"><i class="fa fa-check"></i><b>6.2.5</b> Load Station Detection from Files</a></li>
<li class="chapter" data-level="6.2.6" data-path="node-calibration.html"><a href="node-calibration.html#load-sidekick-calibration-data"><i class="fa fa-check"></i><b>6.2.6</b> Load Sidekick Calibration Data</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="node-calibration.html"><a href="node-calibration.html#calculate-the-rssi-vs.-distance-relationship"><i class="fa fa-check"></i><b>6.3</b> Calculate the RSSI vs. Distance Relationship</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="presenceabsence-analysis.html"><a href="presenceabsence-analysis.html"><i class="fa fa-check"></i><b>7</b> Presence/Absence Analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="presenceabsence-analysis.html"><a href="presenceabsence-analysis.html#set-parameters"><i class="fa fa-check"></i><b>7.1</b> Set parameters</a></li>
<li class="chapter" data-level="7.2" data-path="presenceabsence-analysis.html"><a href="presenceabsence-analysis.html#load-data-from-database-1"><i class="fa fa-check"></i><b>7.2</b> Load data from database</a></li>
<li class="chapter" data-level="7.3" data-path="presenceabsence-analysis.html"><a href="presenceabsence-analysis.html#load-tag-deployment-info"><i class="fa fa-check"></i><b>7.3</b> Load Tag Deployment Info</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="presenceabsence-analysis.html"><a href="presenceabsence-analysis.html#load-tag-deployment-file"><i class="fa fa-check"></i><b>7.3.1</b> Load Tag Deployment File</a></li>
<li class="chapter" data-level="7.3.2" data-path="presenceabsence-analysis.html"><a href="presenceabsence-analysis.html#get-list-of-detected-tags"><i class="fa fa-check"></i><b>7.3.2</b> Get List of Detected Tags</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="presenceabsence-analysis.html"><a href="presenceabsence-analysis.html#generate-detection-summary"><i class="fa fa-check"></i><b>7.4</b> Generate Detection Summary</a></li>
<li class="chapter" data-level="7.5" data-path="presenceabsence-analysis.html"><a href="presenceabsence-analysis.html#show-detection-history-for-a-specific-tag"><i class="fa fa-check"></i><b>7.5</b> Show Detection History for a Specific Tag</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="activity-budget.html"><a href="activity-budget.html"><i class="fa fa-check"></i><b>8</b> Activity Budget</a>
<ul>
<li class="chapter" data-level="8.1" data-path="activity-budget.html"><a href="activity-budget.html#load-settings-1"><i class="fa fa-check"></i><b>8.1</b> Load settings</a></li>
<li class="chapter" data-level="8.2" data-path="activity-budget.html"><a href="activity-budget.html#load-tag-node-detection-data"><i class="fa fa-check"></i><b>8.2</b> Load Tag Node Detection Data</a></li>
<li class="chapter" data-level="8.3" data-path="activity-budget.html"><a href="activity-budget.html#tag-activity"><i class="fa fa-check"></i><b>8.3</b> Tag Activity</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="activity-budget.html"><a href="activity-budget.html#scatter-plot-of-rssi-vs-time-by-node"><i class="fa fa-check"></i><b>8.3.1</b> Scatter Plot of RSSI vs time by Node</a></li>
<li class="chapter" data-level="8.3.2" data-path="activity-budget.html"><a href="activity-budget.html#scatter-plot-of-activity-vs-time-by-node"><i class="fa fa-check"></i><b>8.3.2</b> Scatter Plot of activity vs time by Node</a></li>
<li class="chapter" data-level="8.3.3" data-path="activity-budget.html"><a href="activity-budget.html#d-histogram-of-activity-over-time"><i class="fa fa-check"></i><b>8.3.3</b> 2D Histogram of Activity over Time</a></li>
<li class="chapter" data-level="8.3.4" data-path="activity-budget.html"><a href="activity-budget.html#d-histogram-of-activity-vs-time-with-avg-activity"><i class="fa fa-check"></i><b>8.3.4</b> 2D histogram of activity vs time WITH avg activity</a></li>
<li class="chapter" data-level="8.3.5" data-path="activity-budget.html"><a href="activity-budget.html#avg-activity-hour-vs-time."><i class="fa fa-check"></i><b>8.3.5</b> Avg activity / hour Vs time.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="habitat-use.html"><a href="habitat-use.html"><i class="fa fa-check"></i><b>9</b> Habitat Use</a>
<ul>
<li class="chapter" data-level="9.1" data-path="habitat-use.html"><a href="habitat-use.html#load-libraries-and-settings"><i class="fa fa-check"></i><b>9.1</b> Load libraries and settings</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="habitat-use.html"><a href="habitat-use.html#activate-renv"><i class="fa fa-check"></i><b>9.1.1</b> Activate renv</a></li>
<li class="chapter" data-level="9.1.2" data-path="habitat-use.html"><a href="habitat-use.html#load-libraries-and-settings-1"><i class="fa fa-check"></i><b>9.1.2</b> Load libraries and settings</a></li>
<li class="chapter" data-level="9.1.3" data-path="habitat-use.html"><a href="habitat-use.html#load-functions"><i class="fa fa-check"></i><b>9.1.3</b> Load Functions</a></li>
<li class="chapter" data-level="9.1.4" data-path="habitat-use.html"><a href="habitat-use.html#load-rssi-coefficients"><i class="fa fa-check"></i><b>9.1.4</b> Load RSSI Coefficients</a></li>
<li class="chapter" data-level="9.1.5" data-path="habitat-use.html"><a href="habitat-use.html#load-settings-2"><i class="fa fa-check"></i><b>9.1.5</b> Load Settings</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="habitat-use.html"><a href="habitat-use.html#load-node-health-data-from-files-1"><i class="fa fa-check"></i><b>9.2</b> Load Node Health Data from Files</a></li>
<li class="chapter" data-level="9.3" data-path="habitat-use.html"><a href="habitat-use.html#get-node-locations-1"><i class="fa fa-check"></i><b>9.3</b> Get Node Locations</a></li>
<li class="chapter" data-level="9.4" data-path="habitat-use.html"><a href="habitat-use.html#load-station-detection-data"><i class="fa fa-check"></i><b>9.4</b> Load Station Detection Data</a></li>
<li class="chapter" data-level="9.5" data-path="habitat-use.html"><a href="habitat-use.html#build-a-grid"><i class="fa fa-check"></i><b>9.5</b> Build a Grid</a></li>
<li class="chapter" data-level="9.6" data-path="habitat-use.html"><a href="habitat-use.html#calculate-locations"><i class="fa fa-check"></i><b>9.6</b> Calculate Locations</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="grid-search-analysis.html"><a href="grid-search-analysis.html"><i class="fa fa-check"></i><b>10</b> Grid Search Analysis</a>
<ul>
<li class="chapter" data-level="10.1" data-path="grid-search-analysis.html"><a href="grid-search-analysis.html#loading-settings"><i class="fa fa-check"></i><b>10.1</b> Loading Settings</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="grid-search-analysis.html"><a href="grid-search-analysis.html#activate-renv-1"><i class="fa fa-check"></i><b>10.1.1</b> Activate renv</a></li>
<li class="chapter" data-level="10.1.2" data-path="grid-search-analysis.html"><a href="grid-search-analysis.html#load-libraries"><i class="fa fa-check"></i><b>10.1.2</b> Load libraries</a></li>
<li class="chapter" data-level="10.1.3" data-path="grid-search-analysis.html"><a href="grid-search-analysis.html#load-settings-3"><i class="fa fa-check"></i><b>10.1.3</b> Load settings</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="grid-search-analysis.html"><a href="grid-search-analysis.html#load-node-health-data-from-database"><i class="fa fa-check"></i><b>10.2</b> Load Node Health data from Database</a></li>
<li class="chapter" data-level="10.3" data-path="grid-search-analysis.html"><a href="grid-search-analysis.html#get-node-locations-2"><i class="fa fa-check"></i><b>10.3</b> Get Node Locations</a></li>
<li class="chapter" data-level="10.4" data-path="grid-search-analysis.html"><a href="grid-search-analysis.html#load-station-detection-data-1"><i class="fa fa-check"></i><b>10.4</b> Load Station Detection Data</a></li>
<li class="chapter" data-level="10.5" data-path="grid-search-analysis.html"><a href="grid-search-analysis.html#build-a-node-grid"><i class="fa fa-check"></i><b>10.5</b> Build a Node Grid</a></li>
<li class="chapter" data-level="10.6" data-path="grid-search-analysis.html"><a href="grid-search-analysis.html#optional-calculate-test-solution"><i class="fa fa-check"></i><b>10.6</b> (Optional) Calculate Test Solution</a></li>
<li class="chapter" data-level="10.7" data-path="grid-search-analysis.html"><a href="grid-search-analysis.html#calculate-track"><i class="fa fa-check"></i><b>10.7</b> Calculate Track</a></li>
<li class="chapter" data-level="10.8" data-path="grid-search-analysis.html"><a href="grid-search-analysis.html#optional-compare-with-known-track"><i class="fa fa-check"></i><b>10.8</b> (Optional) Compare with Known Track</a></li>
<li class="chapter" data-level="10.9" data-path="grid-search-analysis.html"><a href="grid-search-analysis.html#plot-uncertainty-analysis"><i class="fa fa-check"></i><b>10.9</b> Plot Uncertainty Analysis</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="multilateration.html"><a href="multilateration.html"><i class="fa fa-check"></i><b>11</b> Multilateration</a>
<ul>
<li class="chapter" data-level="11.1" data-path="multilateration.html"><a href="multilateration.html#load-settings-4"><i class="fa fa-check"></i><b>11.1</b> Load settings</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="multilateration.html"><a href="multilateration.html#reset-rs-brain-remove-all-previous-objects"><i class="fa fa-check"></i><b>11.1.1</b> Reset R’s brain, remove all previous objects</a></li>
<li class="chapter" data-level="11.1.2" data-path="multilateration.html"><a href="multilateration.html#load-libraries-1"><i class="fa fa-check"></i><b>11.1.2</b> Load libraries</a></li>
<li class="chapter" data-level="11.1.3" data-path="multilateration.html"><a href="multilateration.html#re-create-sample-data-from-node-calibration-chapter-5"><i class="fa fa-check"></i><b>11.1.3</b> Re-create sample data from node calibration (Chapter 5)</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="multilateration.html"><a href="multilateration.html#isolate-raw-received-signal-strength-rss-data-from-node-network-associated-with-test-data"><i class="fa fa-check"></i><b>11.2</b> Isolate raw Received Signal Strength (RSS) data from Node network associated with Test Data</a></li>
<li class="chapter" data-level="11.3" data-path="multilateration.html"><a href="multilateration.html#exponential-decay-function---relationship-between-distance-and-tag-rss-values"><i class="fa fa-check"></i><b>11.3</b> Exponential Decay Function - Relationship between Distance and Tag RSS Values</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="multilateration.html"><a href="multilateration.html#preliminary-exponential-decay-model---determine-starting-values-for-the-final-model"><i class="fa fa-check"></i><b>11.3.1</b> Preliminary Exponential Decay Model - Determine starting values for the final model</a></li>
<li class="chapter" data-level="11.3.2" data-path="multilateration.html"><a href="multilateration.html#final-exponential-decay-model"><i class="fa fa-check"></i><b>11.3.2</b> Final Exponential Decay Model</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">‘celltracktech’ Data Analysis package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multilateration" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">Chapter 11</span> Multilateration<a href="multilateration.html#multilateration" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This process is just like habitat use and grid search analysis, but instead of using the RSSI, it uses time difference of arrival instead to calculate the location of an animal.</p>
<p>You should use this method when your node grid is evenly spaced.</p>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/35169450/">Multilateration paper</a></p>
<div id="load-settings-4" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> Load settings<a href="multilateration.html#load-settings-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="reset-rs-brain-remove-all-previous-objects" class="section level3 hasAnchor" number="11.1.1">
<h3><span class="header-section-number">11.1.1</span> Reset R’s brain, remove all previous objects<a href="multilateration.html#reset-rs-brain-remove-all-previous-objects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="multilateration.html#cb83-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb83-2"><a href="multilateration.html#cb83-2" tabindex="-1"></a>tagid <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;072A6633&quot;</span>,<span class="st">&quot;2D4B782D&quot;</span>) <span class="co">#&quot;0C5F5CED&quot;</span></span>
<span id="cb83-3"><a href="multilateration.html#cb83-3" tabindex="-1"></a>timezone<span class="ot">=</span><span class="st">&quot;UTC&quot;</span></span>
<span id="cb83-4"><a href="multilateration.html#cb83-4" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">9</span>) <span class="co"># sets number after decimal</span></span></code></pre></div>
</div>
<div id="load-libraries-1" class="section level3 hasAnchor" number="11.1.2">
<h3><span class="header-section-number">11.1.2</span> Load libraries<a href="multilateration.html#load-libraries-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="multilateration.html#cb84-1" tabindex="-1"></a><span class="fu">library</span>(celltracktech)</span></code></pre></div>
</div>
<div id="re-create-sample-data-from-node-calibration-chapter-5" class="section level3 hasAnchor" number="11.1.3">
<h3><span class="header-section-number">11.1.3</span> Re-create sample data from node calibration (Chapter 5)<a href="multilateration.html#re-create-sample-data-from-node-calibration-chapter-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="multilateration.html#cb85-1" tabindex="-1"></a><span class="co"># create time window by reducing location precision or can input data with TestId column (user-defined window)</span></span>
<span id="cb85-2"><a href="multilateration.html#cb85-2" tabindex="-1"></a></span>
<span id="cb85-3"><a href="multilateration.html#cb85-3" tabindex="-1"></a><span class="co"># load node calibration file from Chapter 5</span></span>
<span id="cb85-4"><a href="multilateration.html#cb85-4" tabindex="-1"></a><span class="co"># mytest &lt;- read.csv(&quot;./calibration_2023_8_3_all.csv&quot;)</span></span>
<span id="cb85-5"><a href="multilateration.html#cb85-5" tabindex="-1"></a>mytest <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/Meadows V2/sidekick/calibration_2023_8_3_all.csv&quot;</span>)</span>
<span id="cb85-6"><a href="multilateration.html#cb85-6" tabindex="-1"></a>mytest<span class="sc">$</span>Time <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(mytest<span class="sc">$</span>time_utc, <span class="at">tz=</span><span class="st">&quot;UTC&quot;</span>)</span>
<span id="cb85-7"><a href="multilateration.html#cb85-7" tabindex="-1"></a></span>
<span id="cb85-8"><a href="multilateration.html#cb85-8" tabindex="-1"></a><span class="co"># connect to database</span></span>
<span id="cb85-9"><a href="multilateration.html#cb85-9" tabindex="-1"></a>con <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(duckdb<span class="sc">::</span><span class="fu">duckdb</span>(), </span>
<span id="cb85-10"><a href="multilateration.html#cb85-10" tabindex="-1"></a>                      <span class="at">dbdir =</span> <span class="st">&quot;./data/Meadows V2/meadows.duckdb&quot;</span>, </span>
<span id="cb85-11"><a href="multilateration.html#cb85-11" tabindex="-1"></a>                      <span class="at">read_only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-12"><a href="multilateration.html#cb85-12" tabindex="-1"></a></span>
<span id="cb85-13"><a href="multilateration.html#cb85-13" tabindex="-1"></a><span class="co"># filter for specific dates and for the specified tags in tag id</span></span>
<span id="cb85-14"><a href="multilateration.html#cb85-14" tabindex="-1"></a>testdata <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, <span class="st">&quot;raw&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb85-15"><a href="multilateration.html#cb85-15" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2023-07-31&quot;</span>) <span class="sc">&amp;&amp;</span> time <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2023-10-31&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb85-16"><a href="multilateration.html#cb85-16" tabindex="-1"></a>  <span class="fu">filter</span>(tag_id <span class="sc">%in%</span> tagid) <span class="sc">|&gt;</span></span>
<span id="cb85-17"><a href="multilateration.html#cb85-17" tabindex="-1"></a>  <span class="fu">collect</span>()</span>
<span id="cb85-18"><a href="multilateration.html#cb85-18" tabindex="-1"></a></span>
<span id="cb85-19"><a href="multilateration.html#cb85-19" tabindex="-1"></a><span class="co"># set node start and stop dates</span></span>
<span id="cb85-20"><a href="multilateration.html#cb85-20" tabindex="-1"></a>start_buff <span class="ot">=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2023-08-01&quot;</span>, <span class="at">tz=</span><span class="st">&quot;UTC&quot;</span>)</span>
<span id="cb85-21"><a href="multilateration.html#cb85-21" tabindex="-1"></a>end_buff <span class="ot">=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2023-08-07&quot;</span>, <span class="at">tz=</span><span class="st">&quot;UTC&quot;</span>)</span>
<span id="cb85-22"><a href="multilateration.html#cb85-22" tabindex="-1"></a></span>
<span id="cb85-23"><a href="multilateration.html#cb85-23" tabindex="-1"></a>nodehealth <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, <span class="st">&quot;node_health&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb85-24"><a href="multilateration.html#cb85-24" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">&gt;=</span> start_buff  <span class="sc">&amp;&amp;</span> time <span class="sc">&lt;=</span> end_buff) <span class="sc">|&gt;</span></span>
<span id="cb85-25"><a href="multilateration.html#cb85-25" tabindex="-1"></a>  <span class="fu">collect</span>()</span>
<span id="cb85-26"><a href="multilateration.html#cb85-26" tabindex="-1"></a></span>
<span id="cb85-27"><a href="multilateration.html#cb85-27" tabindex="-1"></a><span class="co"># disconnect from database</span></span>
<span id="cb85-28"><a href="multilateration.html#cb85-28" tabindex="-1"></a>DBI<span class="sc">::</span><span class="fu">dbDisconnect</span>(con)</span>
<span id="cb85-29"><a href="multilateration.html#cb85-29" tabindex="-1"></a></span>
<span id="cb85-30"><a href="multilateration.html#cb85-30" tabindex="-1"></a><span class="co"># create dataframe of nodes and their locations (lat, lon)</span></span>
<span id="cb85-31"><a href="multilateration.html#cb85-31" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">node_file</span>(nodehealth)</span></code></pre></div>
</div>
</div>
<div id="isolate-raw-received-signal-strength-rss-data-from-node-network-associated-with-test-data" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> Isolate raw Received Signal Strength (RSS) data from Node network associated with Test Data<a href="multilateration.html#isolate-raw-received-signal-strength-rss-data-from-node-network-associated-with-test-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="multilateration.html#cb86-1" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">data.setup</span>(mytest, </span>
<span id="cb86-2"><a href="multilateration.html#cb86-2" tabindex="-1"></a>                            testdata, </span>
<span id="cb86-3"><a href="multilateration.html#cb86-3" tabindex="-1"></a>                            nodes, </span>
<span id="cb86-4"><a href="multilateration.html#cb86-4" tabindex="-1"></a>                            <span class="at">tag_col =</span> <span class="st">&quot;tag_id&quot;</span>, </span>
<span id="cb86-5"><a href="multilateration.html#cb86-5" tabindex="-1"></a>                            <span class="at">tagid =</span> <span class="st">&quot;072A6633&quot;</span>, </span>
<span id="cb86-6"><a href="multilateration.html#cb86-6" tabindex="-1"></a>                            <span class="at">time_col =</span> <span class="st">&quot;Time&quot;</span>,</span>
<span id="cb86-7"><a href="multilateration.html#cb86-7" tabindex="-1"></a>                            <span class="at">timezone =</span> <span class="st">&quot;UTC&quot;</span>,</span>
<span id="cb86-8"><a href="multilateration.html#cb86-8" tabindex="-1"></a>                            <span class="at">x =</span> <span class="st">&quot;lon&quot;</span>,</span>
<span id="cb86-9"><a href="multilateration.html#cb86-9" tabindex="-1"></a>                            <span class="at">y =</span> <span class="st">&quot;lat&quot;</span>, </span>
<span id="cb86-10"><a href="multilateration.html#cb86-10" tabindex="-1"></a>                            <span class="at">loc_precision =</span> <span class="dv">6</span>, </span>
<span id="cb86-11"><a href="multilateration.html#cb86-11" tabindex="-1"></a>                            <span class="at">fileloc =</span> <span class="st">&quot;./data/Meadows V2/meadows.duckdb&quot;</span>, </span>
<span id="cb86-12"><a href="multilateration.html#cb86-12" tabindex="-1"></a>                            <span class="at">filetype =</span> <span class="st">&quot;raw&quot;</span>)</span></code></pre></div>
</div>
<div id="exponential-decay-function---relationship-between-distance-and-tag-rss-values" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> Exponential Decay Function - Relationship between Distance and Tag RSS Values<a href="multilateration.html#exponential-decay-function---relationship-between-distance-and-tag-rss-values" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="multilateration.html#cb87-1" tabindex="-1"></a><span class="co"># Plot of the relationship between RSS and distance</span></span>
<span id="cb87-2"><a href="multilateration.html#cb87-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> combined_data, </span>
<span id="cb87-3"><a href="multilateration.html#cb87-3" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> distance, </span>
<span id="cb87-4"><a href="multilateration.html#cb87-4" tabindex="-1"></a>           <span class="at">y =</span> avgRSS, </span>
<span id="cb87-5"><a href="multilateration.html#cb87-5" tabindex="-1"></a>           <span class="at">color =</span> node_id)) <span class="sc">+</span> </span>
<span id="cb87-6"><a href="multilateration.html#cb87-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>As distance increases, we see average RSS decreasing exponentially.</p>
<div id="preliminary-exponential-decay-model---determine-starting-values-for-the-final-model" class="section level3 hasAnchor" number="11.3.1">
<h3><span class="header-section-number">11.3.1</span> Preliminary Exponential Decay Model - Determine starting values for the final model<a href="multilateration.html#preliminary-exponential-decay-model---determine-starting-values-for-the-final-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>SSasvmp - self start for exponential model to find the data starting values</li>
<li>Asvm - horizontal asymptote (when large values) - y values decay to this value</li>
<li>R0 - numeric value when avgRSS (i.e., response variable) = 0</li>
<li>lrc - natural logarithm of the rate constant (rate of decay)</li>
</ul>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="multilateration.html#cb88-1" tabindex="-1"></a><span class="co"># preliminary model - non-linear sampling</span></span>
<span id="cb88-2"><a href="multilateration.html#cb88-2" tabindex="-1"></a>exp.mod <span class="ot">&lt;-</span> <span class="fu">nls</span>(avgRSS <span class="sc">~</span> <span class="fu">SSasymp</span>(distance, </span>
<span id="cb88-3"><a href="multilateration.html#cb88-3" tabindex="-1"></a>                                Asym, </span>
<span id="cb88-4"><a href="multilateration.html#cb88-4" tabindex="-1"></a>                                R0, </span>
<span id="cb88-5"><a href="multilateration.html#cb88-5" tabindex="-1"></a>                                lrc), </span>
<span id="cb88-6"><a href="multilateration.html#cb88-6" tabindex="-1"></a>               <span class="at">data =</span> combined_data)</span>
<span id="cb88-7"><a href="multilateration.html#cb88-7" tabindex="-1"></a></span>
<span id="cb88-8"><a href="multilateration.html#cb88-8" tabindex="-1"></a>  <span class="co"># Summary of Model</span></span>
<span id="cb88-9"><a href="multilateration.html#cb88-9" tabindex="-1"></a><span class="fu">summary</span>(exp.mod)</span>
<span id="cb88-10"><a href="multilateration.html#cb88-10" tabindex="-1"></a>  <span class="co"># rate of decay</span></span>
<span id="cb88-11"><a href="multilateration.html#cb88-11" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(exp.mod)[[<span class="st">&quot;lrc&quot;</span>]])</span></code></pre></div>
</div>
<div id="final-exponential-decay-model" class="section level3 hasAnchor" number="11.3.2">
<h3><span class="header-section-number">11.3.2</span> Final Exponential Decay Model<a href="multilateration.html#final-exponential-decay-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>User provides self-starting values based on visualization of the data and values in the Preiliminary Model Output</p>
<p>exponential model formula: avgRSS ~ a * exp(-S * distance) + K</p>
<ul>
<li>a = intercept</li>
<li>S = decay factor</li>
<li>K = horizontal asymptote</li>
</ul>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="multilateration.html#cb89-1" tabindex="-1"></a><span class="do">##  ***** Variables to define for final model below - replace values below with values from exp.mod ****  ## </span></span>
<span id="cb89-2"><a href="multilateration.html#cb89-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">coef</span>(exp.mod)[[<span class="st">&quot;R0&quot;</span>]]</span>
<span id="cb89-3"><a href="multilateration.html#cb89-3" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(exp.mod)[[<span class="st">&quot;lrc&quot;</span>]])</span>
<span id="cb89-4"><a href="multilateration.html#cb89-4" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">coef</span>(exp.mod)[[<span class="st">&quot;Asym&quot;</span>]]</span>
<span id="cb89-5"><a href="multilateration.html#cb89-5" tabindex="-1"></a>  </span>
<span id="cb89-6"><a href="multilateration.html#cb89-6" tabindex="-1"></a>  <span class="co"># Final Model</span></span>
<span id="cb89-7"><a href="multilateration.html#cb89-7" tabindex="-1"></a>nls.mod <span class="ot">&lt;-</span> <span class="fu">nls</span>(avgRSS <span class="sc">~</span> a <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>S <span class="sc">*</span> distance) <span class="sc">+</span> K, </span>
<span id="cb89-8"><a href="multilateration.html#cb89-8" tabindex="-1"></a>               <span class="at">start =</span> <span class="fu">list</span>(<span class="at">a =</span> a, </span>
<span id="cb89-9"><a href="multilateration.html#cb89-9" tabindex="-1"></a>                            <span class="at">S =</span> S, </span>
<span id="cb89-10"><a href="multilateration.html#cb89-10" tabindex="-1"></a>                            <span class="at">K=</span> K), </span>
<span id="cb89-11"><a href="multilateration.html#cb89-11" tabindex="-1"></a>               <span class="at">data =</span> combined_data)</span>
<span id="cb89-12"><a href="multilateration.html#cb89-12" tabindex="-1"></a></span>
<span id="cb89-13"><a href="multilateration.html#cb89-13" tabindex="-1"></a>  <span class="co"># Model Summary</span></span>
<span id="cb89-14"><a href="multilateration.html#cb89-14" tabindex="-1"></a><span class="fu">summary</span>(nls.mod)</span>
<span id="cb89-15"><a href="multilateration.html#cb89-15" tabindex="-1"></a></span>
<span id="cb89-16"><a href="multilateration.html#cb89-16" tabindex="-1"></a>  <span class="co"># Model Coefficients </span></span>
<span id="cb89-17"><a href="multilateration.html#cb89-17" tabindex="-1"></a><span class="fu">coef</span>(nls.mod)</span>
<span id="cb89-18"><a href="multilateration.html#cb89-18" tabindex="-1"></a></span>
<span id="cb89-19"><a href="multilateration.html#cb89-19" tabindex="-1"></a><span class="do">## Check the fit of the model and get predicted values</span></span>
<span id="cb89-20"><a href="multilateration.html#cb89-20" tabindex="-1"></a>  <span class="co"># Get residuals and fit of model and add variables to main table</span></span>
<span id="cb89-21"><a href="multilateration.html#cb89-21" tabindex="-1"></a>combined_data<span class="sc">$</span>E <span class="ot">&lt;-</span> <span class="fu">residuals</span>(nls.mod)</span>
<span id="cb89-22"><a href="multilateration.html#cb89-22" tabindex="-1"></a>combined_data<span class="sc">$</span>fit <span class="ot">&lt;-</span> <span class="fu">fitted</span>(nls.mod)</span>
<span id="cb89-23"><a href="multilateration.html#cb89-23" tabindex="-1"></a></span>
<span id="cb89-24"><a href="multilateration.html#cb89-24" tabindex="-1"></a>  <span class="co"># Plot residuals by fit or distance</span></span>
<span id="cb89-25"><a href="multilateration.html#cb89-25" tabindex="-1"></a><span class="co">#ggplot(combined_data, aes(x = distance, y = E, color = node_id)) +</span></span>
<span id="cb89-26"><a href="multilateration.html#cb89-26" tabindex="-1"></a><span class="co">#        geom_point(size = 2)</span></span>
<span id="cb89-27"><a href="multilateration.html#cb89-27" tabindex="-1"></a></span>
<span id="cb89-28"><a href="multilateration.html#cb89-28" tabindex="-1"></a><span class="co">#ggplot(combined_data, aes(x = fit, y = E, color = node_id)) +</span></span>
<span id="cb89-29"><a href="multilateration.html#cb89-29" tabindex="-1"></a><span class="co">#  geom_point(size = 2)</span></span>
<span id="cb89-30"><a href="multilateration.html#cb89-30" tabindex="-1"></a></span>
<span id="cb89-31"><a href="multilateration.html#cb89-31" tabindex="-1"></a>  <span class="co"># Get model predictions</span></span>
<span id="cb89-32"><a href="multilateration.html#cb89-32" tabindex="-1"></a>combined_data<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(nls.mod)</span>
<span id="cb89-33"><a href="multilateration.html#cb89-33" tabindex="-1"></a></span>
<span id="cb89-34"><a href="multilateration.html#cb89-34" tabindex="-1"></a><span class="do">## Plot with predicted line</span></span>
<span id="cb89-35"><a href="multilateration.html#cb89-35" tabindex="-1"></a><span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> distance,</span>
<span id="cb89-36"><a href="multilateration.html#cb89-36" tabindex="-1"></a>                          <span class="at">y =</span> avgRSS, </span>
<span id="cb89-37"><a href="multilateration.html#cb89-37" tabindex="-1"></a>                          <span class="at">color=</span>node_id)) <span class="sc">+</span> </span>
<span id="cb89-38"><a href="multilateration.html#cb89-38" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb89-39"><a href="multilateration.html#cb89-39" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred), <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="fl">1.25</span>) <span class="sc">+</span></span>
<span id="cb89-40"><a href="multilateration.html#cb89-40" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">&quot;RSS (dB)&quot;</span>) <span class="sc">+</span></span>
<span id="cb89-41"><a href="multilateration.html#cb89-41" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Distance (m)&quot;</span>) <span class="sc">+</span></span>
<span id="cb89-42"><a href="multilateration.html#cb89-42" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb89-43"><a href="multilateration.html#cb89-43" tabindex="-1"></a></span>
<span id="cb89-44"><a href="multilateration.html#cb89-44" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">coef</span>(nls.mod)[<span class="dv">1</span>])</span>
<span id="cb89-45"><a href="multilateration.html#cb89-45" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">coef</span>(nls.mod)[<span class="dv">2</span>])</span>
<span id="cb89-46"><a href="multilateration.html#cb89-46" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">coef</span>(nls.mod)[<span class="dv">3</span>])</span>
<span id="cb89-47"><a href="multilateration.html#cb89-47" tabindex="-1"></a></span>
<span id="cb89-48"><a href="multilateration.html#cb89-48" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">estimate.distance</span>(combined_data, K, a, S)</span>
<span id="cb89-49"><a href="multilateration.html#cb89-49" tabindex="-1"></a></span>
<span id="cb89-50"><a href="multilateration.html#cb89-50" tabindex="-1"></a>tile_url <span class="ot">=</span> <span class="st">&quot;https://tile.openstreetmap.org/{z}/{x}/{y}.png&quot;</span></span>
<span id="cb89-51"><a href="multilateration.html#cb89-51" tabindex="-1"></a>testout <span class="ot">&lt;-</span> combined_data[combined_data<span class="sc">$</span>TestId<span class="sc">==</span><span class="dv">0</span>,]</span>
<span id="cb89-52"><a href="multilateration.html#cb89-52" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb89-53"><a href="multilateration.html#cb89-53" tabindex="-1"></a>    <span class="fu">addTiles</span>(</span>
<span id="cb89-54"><a href="multilateration.html#cb89-54" tabindex="-1"></a>      <span class="at">urlTemplate =</span> tile_url,</span>
<span id="cb89-55"><a href="multilateration.html#cb89-55" tabindex="-1"></a>      <span class="at">options =</span> <span class="fu">tileOptions</span>(<span class="at">maxZoom =</span> <span class="dv">25</span>)</span>
<span id="cb89-56"><a href="multilateration.html#cb89-56" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb89-57"><a href="multilateration.html#cb89-57" tabindex="-1"></a>    <span class="fu">addCircleMarkers</span>(</span>
<span id="cb89-58"><a href="multilateration.html#cb89-58" tabindex="-1"></a>      <span class="at">data =</span> nodes,</span>
<span id="cb89-59"><a href="multilateration.html#cb89-59" tabindex="-1"></a>      <span class="at">lat =</span> nodes<span class="sc">$</span>node_lat,</span>
<span id="cb89-60"><a href="multilateration.html#cb89-60" tabindex="-1"></a>      <span class="at">lng =</span> nodes<span class="sc">$</span>node_lng,</span>
<span id="cb89-61"><a href="multilateration.html#cb89-61" tabindex="-1"></a>      <span class="at">radius =</span> <span class="dv">5</span>,</span>
<span id="cb89-62"><a href="multilateration.html#cb89-62" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;cyan&quot;</span>,</span>
<span id="cb89-63"><a href="multilateration.html#cb89-63" tabindex="-1"></a>      <span class="at">fillColor =</span> <span class="st">&quot;cyan&quot;</span>,</span>
<span id="cb89-64"><a href="multilateration.html#cb89-64" tabindex="-1"></a>      <span class="at">fillOpacity =</span> <span class="fl">0.5</span>,</span>
<span id="cb89-65"><a href="multilateration.html#cb89-65" tabindex="-1"></a>      <span class="at">label =</span> nodes<span class="sc">$</span>node_id</span>
<span id="cb89-66"><a href="multilateration.html#cb89-66" tabindex="-1"></a>    )  <span class="sc">%&gt;%</span></span>
<span id="cb89-67"><a href="multilateration.html#cb89-67" tabindex="-1"></a>    <span class="fu">addCircles</span>(</span>
<span id="cb89-68"><a href="multilateration.html#cb89-68" tabindex="-1"></a>      <span class="at">data=</span>testout, </span>
<span id="cb89-69"><a href="multilateration.html#cb89-69" tabindex="-1"></a>      <span class="at">lat =</span> testout<span class="sc">$</span>node_lat,</span>
<span id="cb89-70"><a href="multilateration.html#cb89-70" tabindex="-1"></a>      <span class="at">lng =</span> testout<span class="sc">$</span>node_lng,</span>
<span id="cb89-71"><a href="multilateration.html#cb89-71" tabindex="-1"></a>      <span class="at">radius =</span> testout<span class="sc">$</span>distance,</span>
<span id="cb89-72"><a href="multilateration.html#cb89-72" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb89-73"><a href="multilateration.html#cb89-73" tabindex="-1"></a>      <span class="co">#fillColor = &quot;red&quot;,</span></span>
<span id="cb89-74"><a href="multilateration.html#cb89-74" tabindex="-1"></a>      <span class="at">fillOpacity =</span> <span class="dv">0</span>)</span>
<span id="cb89-75"><a href="multilateration.html#cb89-75" tabindex="-1"></a></span>
<span id="cb89-76"><a href="multilateration.html#cb89-76" tabindex="-1"></a>no.filters <span class="ot">&lt;-</span> <span class="fu">trilateration.TestData.NoFilter</span>(combined_data)</span>
<span id="cb89-77"><a href="multilateration.html#cb89-77" tabindex="-1"></a>RSS.FILTER <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">80</span>, <span class="sc">-</span><span class="dv">85</span>, <span class="sc">-</span><span class="dv">90</span>, <span class="sc">-</span><span class="dv">95</span>)</span>
<span id="cb89-78"><a href="multilateration.html#cb89-78" tabindex="-1"></a>RSS.filters <span class="ot">&lt;-</span> <span class="fu">trilateration.TestData.RSS.Filter</span>(combined_data, RSS.FILTER)</span>
<span id="cb89-79"><a href="multilateration.html#cb89-79" tabindex="-1"></a><span class="co">#DIST.FILTER &lt;- c(315,500,750,1000)</span></span>
<span id="cb89-80"><a href="multilateration.html#cb89-80" tabindex="-1"></a><span class="co"># Calculate error of location estimates of each test location when Distance filters are applied prior to trilateration </span></span>
<span id="cb89-81"><a href="multilateration.html#cb89-81" tabindex="-1"></a><span class="co">#Dist.filters &lt;- trilateration.TestData.Distance.Filter(combined_data, DIST.FILTER)</span></span>
<span id="cb89-82"><a href="multilateration.html#cb89-82" tabindex="-1"></a></span>
<span id="cb89-83"><a href="multilateration.html#cb89-83" tabindex="-1"></a>SLIDE.TIME <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb89-84"><a href="multilateration.html#cb89-84" tabindex="-1"></a>GROUP.TIME <span class="ot">&lt;-</span> <span class="st">&quot;1 min&quot;</span></span>
<span id="cb89-85"><a href="multilateration.html#cb89-85" tabindex="-1"></a></span>
<span id="cb89-86"><a href="multilateration.html#cb89-86" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> testdata <span class="sc">%&gt;%</span></span>
<span id="cb89-87"><a href="multilateration.html#cb89-87" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2023-10-05&quot;</span>) <span class="sc">&amp;</span> time <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2023-10-15&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb89-88"><a href="multilateration.html#cb89-88" tabindex="-1"></a>  <span class="fu">filter</span>(tag_id <span class="sc">==</span> <span class="st">&quot;2D4B782D&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-89"><a href="multilateration.html#cb89-89" tabindex="-1"></a>  <span class="fu">collect</span>()</span>
<span id="cb89-90"><a href="multilateration.html#cb89-90" tabindex="-1"></a></span>
<span id="cb89-91"><a href="multilateration.html#cb89-91" tabindex="-1"></a><span class="co"># Function to prepare beep data for trilateration </span></span>
<span id="cb89-92"><a href="multilateration.html#cb89-92" tabindex="-1"></a><span class="co"># by estimating distance of a signal based on RSS values</span></span>
<span id="cb89-93"><a href="multilateration.html#cb89-93" tabindex="-1"></a>beep.grouped <span class="ot">&lt;-</span> <span class="fu">prep.data</span>(test_data,</span>
<span id="cb89-94"><a href="multilateration.html#cb89-94" tabindex="-1"></a>                          nodes,</span>
<span id="cb89-95"><a href="multilateration.html#cb89-95" tabindex="-1"></a>                          SLIDE.TIME,</span>
<span id="cb89-96"><a href="multilateration.html#cb89-96" tabindex="-1"></a>                          GROUP.TIME,</span>
<span id="cb89-97"><a href="multilateration.html#cb89-97" tabindex="-1"></a>                          K, </span>
<span id="cb89-98"><a href="multilateration.html#cb89-98" tabindex="-1"></a>                          a, </span>
<span id="cb89-99"><a href="multilateration.html#cb89-99" tabindex="-1"></a>                          S) </span>
<span id="cb89-100"><a href="multilateration.html#cb89-100" tabindex="-1"></a></span>
<span id="cb89-101"><a href="multilateration.html#cb89-101" tabindex="-1"></a>RSS.filter <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">95</span></span>
<span id="cb89-102"><a href="multilateration.html#cb89-102" tabindex="-1"></a>location.estimates <span class="ot">&lt;-</span> <span class="fu">trilateration</span>(beep.grouped, nodes, RSS.FILTER)</span>
<span id="cb89-103"><a href="multilateration.html#cb89-103" tabindex="-1"></a></span>
<span id="cb89-104"><a href="multilateration.html#cb89-104" tabindex="-1"></a><span class="co"># this will take a while...</span></span>
<span id="cb89-105"><a href="multilateration.html#cb89-105" tabindex="-1"></a><span class="fu">mapping</span>(nodes, location.estimates)</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="grid-search-analysis.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/rstudio/bookdown-demo/edit/master/10-multilateration.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

</body>

</html>
